  - hosts: localhost
    become: yes
    tasks:

    - name: upgrade all packages
      yum:
        name: '*'
        state: latest

    - name: Install packages
      yum:
        name:
          - podman
          - podman-docker
          - vim
          - ansible
          - yum-utils
        state: latest
        cache_valid_time: 3600

    - name: Do nothing when laptop lid is closed
      lineinfile: dest=/etc/systemd/logind.conf
              regexp="^#HandleLidSwitch=suspend"
              line="HandleLidSwitch=ignore"
              state=present
      notify: Restart systemd-logind

    - name: Disallow password authentication
      lineinfile: dest=/etc/ssh/sshd_config
              regexp="^PasswordAuthentication"
              line="PasswordAuthentication no"
              state=present
      notify: Restart ssh

    - name: Disallow root SSH access
      lineinfile: dest=/etc/ssh/sshd_config
              regexp="^PermitRootLogin"
              line="PermitRootLogin no"
              state=present
      notify: Restart ssh
